/*! angularjs-google-places 25-09-2013 */
"use strict";
angular.module("ngGPlaces", []), angular.module("ngGPlaces").value("gPlaces", google.maps.places), angular.module("ngGPlaces").value("gMaps", google.maps), angular.module("ngGPlaces").provider("ngGPlacesAPI", function () {
    var a = {
        radius: 1e3,
        sensor: !1,
        latitude: null,
        longitude: null,
        types: ["food"],
        map: null,
        elem: null,
        nearbySearchKeys: ["name", "reference", "vicinity"],
        placeDetailsKeys: ["formatted_address", "formatted_phone_number", "reference", "website"],
        nearbySearchErr: "Unable to find nearby places",
        placeDetailsErr: "Unable to find place details",
        _nearbySearchApiFnCall: "nearbySearch",
        _placeDetailsApiFnCall: "getDetails"
    }, b = function (b) {
        var c = [], d = a.nearbySearchKeys;
        return b.map(function (a) {
            var b = {};
            angular.forEach(d, function (c) {
                b[c] = a[c]
            }), c.push(b)
        }), c
    }, c = function (b) {
        var c = {}, d = a.placeDetailsKeys;
        return angular.forEach(d, function (a) {
            c[a] = b[a]
        }), c
    };
    this.$get = function (d, e, f, g, h) {
        function i(b) {
            function c(a, b) {
                b == g.PlacesServiceStatus.OK ? d.$apply(function () {
                    return l.resolve(i._parser(a))
                }) : d.$apply(function () {
                    l.reject(i._errorMsg)
                })
            }

            var i = angular.copy(a, {});
            angular.extend(i, b);
            var j, k, l = e.defer();
            return i._genLocation && (i.location = new f.LatLng(i.latitude, i.longitude)), j = i.map ? i.map : i.elem ? i.elem : h.document.createElement("div"), k = new g.PlacesService(j), k[i._apiFnCall](i, c), l.promise
        }

        return {
            getDefaults: function () {
                return a
            }, nearbySearch: function (c) {
                return c._genLocation = !0, c._errorMsg = a.nearbySearchErr, c._parser = b, c._apiFnCall = a._nearbySearchApiFnCall, i(c)
            }, placeDetails: function (b) {
                return b._errorMsg = a.placeDetailsErr, b._parser = c, b._apiFnCall = a._placeDetailsApiFnCall, i(b)
            }
        }
    }, this.$get.$inject = ["$rootScope", "$q", "gMaps", "gPlaces", "$window"], this.setDefaults = function (b) {
        angular.extend(a, b)
    }
});